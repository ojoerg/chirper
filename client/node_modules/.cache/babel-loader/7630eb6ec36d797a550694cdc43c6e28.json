{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\Olli\\\\Projects\\\\full stack\\\\complete\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\Olli\\\\Projects\\\\full stack\\\\complete\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:\\\\Users\\\\Olli\\\\Projects\\\\full stack\\\\complete\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{createContext,useReducer}from\"react\";import AppReducer from\"./AppReducer\";// Initial State\nvar initialState={popup:false,posts:[],error:null,loading:true,user:\"test\"};// Create context\nexport var GlobalContext=createContext(initialState);// Provider Component\nexport var GlobalProvider=function GlobalProvider(_ref){var children=_ref.children;var _useReducer=useReducer(AppReducer,initialState),_useReducer2=_slicedToArray(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];// Actions\nfunction getPosts(){return _getPosts.apply(this,arguments);}function _getPosts(){_getPosts=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res,posts;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch(\"api/v1/posts\");case 3:res=_context.sent;_context.next=6;return res.json();case 6:posts=_context.sent;console.log(posts.data);dispatch({type:\"GET_POSTS\",payload:posts.data});_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);dispatch({type:\"POST_ERROR\",payload:_context.t0.response.data.error});case 14:case\"end\":return _context.stop();}}},_callee,null,[[0,11]]);}));return _getPosts.apply(this,arguments);}function togglePopup(boolVal){dispatch({type:\"TOGGLE_POPUP\",payload:boolVal});}function addPost(_x){return _addPost.apply(this,arguments);}/*function addPost(postText){\r\n        dispatch({\r\n            type: \"ADD_POST\",\r\n            payload: postText\r\n        })\r\n    }*/function _addPost(){_addPost=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(post){var res,response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return fetch(\"api/v1/posts\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(post)});case 3:res=_context2.sent;_context2.next=6;return res.json();case 6:response=_context2.sent;console.log(response);dispatch({type:\"ADD_POST\",payload:response.data});_context2.next=14;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](0);dispatch({type:\"POST_ERROR\",payload:_context2.t0.response.data.error});case 14:case\"end\":return _context2.stop();}}},_callee2,null,[[0,11]]);}));return _addPost.apply(this,arguments);}return React.createElement(GlobalContext.Provider,{value:{popup:state.popup,posts:state.posts,error:state.error,loading:state.loading,getPosts:getPosts,togglePopup:togglePopup,addPost:addPost}},children);};","map":{"version":3,"sources":["C:/Users/Olli/Projects/full stack/complete/client/src/context/GlobalState.js"],"names":["React","createContext","useReducer","AppReducer","initialState","popup","posts","error","loading","user","GlobalContext","GlobalProvider","children","state","dispatch","getPosts","fetch","res","json","console","log","data","type","payload","response","togglePopup","boolVal","addPost","post","method","headers","body","JSON","stringify"],"mappings":"shBAAA,MAAOA,CAAAA,KAAP,EAAgBC,aAAhB,CAA+BC,UAA/B,KAAiD,OAAjD,CACA,MAAOC,CAAAA,UAAP,KAAuB,cAAvB,CAEA;AAEA,GAAMC,CAAAA,YAAY,CAAG,CACnBC,KAAK,CAAE,KADY,CAEnBC,KAAK,CAAE,EAFY,CAGnBC,KAAK,CAAE,IAHY,CAInBC,OAAO,CAAE,IAJU,CAKnBC,IAAI,CAAE,MALa,CAArB,CAQA;AACA,MAAO,IAAMC,CAAAA,aAAa,CAAGT,aAAa,CAACG,YAAD,CAAnC,CAEP;AACA,MAAO,IAAMO,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,MAAkB,IAAfC,CAAAA,QAAe,MAAfA,QAAe,iBACpBV,UAAU,CAACC,UAAD,CAAaC,YAAb,CADU,4CACvCS,KADuC,iBAChCC,QADgC,iBAG9C;AAH8C,QAI/BC,CAAAA,QAJ+B,kIAI9C,uLAEsBC,CAAAA,KAAK,CAAC,cAAD,CAF3B,QAEUC,GAFV,qCAGwBA,CAAAA,GAAG,CAACC,IAAJ,EAHxB,QAGUZ,KAHV,eAIIa,OAAO,CAACC,GAAR,CAAYd,KAAK,CAACe,IAAlB,EAEAP,QAAQ,CAAC,CACPQ,IAAI,CAAE,WADC,CAEPC,OAAO,CAAEjB,KAAK,CAACe,IAFR,CAAD,CAAR,CANJ,iFAWIP,QAAQ,CAAC,CACPQ,IAAI,CAAE,YADC,CAEPC,OAAO,CAAE,YAAIC,QAAJ,CAAaH,IAAb,CAAkBd,KAFpB,CAAD,CAAR,CAXJ,qEAJ8C,2CAsB9C,QAASkB,CAAAA,WAAT,CAAqBC,OAArB,CAA8B,CAC5BZ,QAAQ,CAAC,CACPQ,IAAI,CAAE,cADC,CAEPC,OAAO,CAAEG,OAFF,CAAD,CAAR,CAID,CA3B6C,QA6B/BC,CAAAA,OA7B+B,4CAsD9C;;;;;OAtD8C,qFA6B9C,kBAAuBC,IAAvB,+KAEsBZ,CAAAA,KAAK,CAAC,cAAD,CAAiB,CACtCa,MAAM,CAAE,MAD8B,CAEtCC,OAAO,CAAE,CACP,eAAgB,kBADT,CAF6B,CAKtCC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAeL,IAAf,CALgC,CAAjB,CAF3B,QAEUX,GAFV,uCAS2BA,CAAAA,GAAG,CAACC,IAAJ,EAT3B,QASUM,QATV,gBAWIL,OAAO,CAACC,GAAR,CAAYI,QAAZ,EAEAV,QAAQ,CAAC,CACPQ,IAAI,CAAE,UADC,CAEPC,OAAO,CAAEC,QAAQ,CAACH,IAFX,CAAD,CAAR,CAbJ,qFAkBIP,QAAQ,CAAC,CACPQ,IAAI,CAAE,YADC,CAEPC,OAAO,CAAE,aAAIC,QAAJ,CAAaH,IAAb,CAAkBd,KAFpB,CAAD,CAAR,CAlBJ,uEA7B8C,0CA6D9C,MACE,qBAAC,aAAD,CAAe,QAAf,EACE,KAAK,CAAE,CACLF,KAAK,CAAEQ,KAAK,CAACR,KADR,CAELC,KAAK,CAAEO,KAAK,CAACP,KAFR,CAGLC,KAAK,CAAEM,KAAK,CAACN,KAHR,CAILC,OAAO,CAAEK,KAAK,CAACL,OAJV,CAKLO,QAAQ,CAARA,QALK,CAMLU,WAAW,CAAXA,WANK,CAOLE,OAAO,CAAPA,OAPK,CADT,EAUGf,QAVH,CADF,CAcD,CA3EM","sourcesContent":["import React, { createContext, useReducer } from \"react\";\r\nimport AppReducer from \"./AppReducer\";\r\n\r\n// Initial State\r\n\r\nconst initialState = {\r\n  popup: false,\r\n  posts: [],\r\n  error: null,\r\n  loading: true,\r\n  user: \"test\"\r\n};\r\n\r\n// Create context\r\nexport const GlobalContext = createContext(initialState);\r\n\r\n// Provider Component\r\nexport const GlobalProvider = ({ children }) => {\r\n  const [state, dispatch] = useReducer(AppReducer, initialState);\r\n\r\n  // Actions\r\n  async function getPosts() {\r\n    try {\r\n      const res = await fetch(\"api/v1/posts\");\r\n      const posts = await res.json();\r\n      console.log(posts.data);\r\n\r\n      dispatch({\r\n        type: \"GET_POSTS\",\r\n        payload: posts.data\r\n      });\r\n    } catch (err) {\r\n      dispatch({\r\n        type: \"POST_ERROR\",\r\n        payload: err.response.data.error\r\n      });\r\n    }\r\n  }\r\n\r\n  function togglePopup(boolVal) {\r\n    dispatch({\r\n      type: \"TOGGLE_POPUP\",\r\n      payload: boolVal\r\n    });\r\n  }\r\n\r\n  async function addPost(post) {\r\n    try {\r\n      const res = await fetch(\"api/v1/posts\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\"\r\n        },\r\n        body: JSON.stringify(post)\r\n      });\r\n      const response = await res.json();\r\n\r\n      console.log(response);\r\n\r\n      dispatch({\r\n        type: \"ADD_POST\",\r\n        payload: response.data\r\n      });\r\n    } catch (err) {\r\n      dispatch({\r\n        type: \"POST_ERROR\",\r\n        payload: err.response.data.error\r\n      });\r\n    }\r\n  }\r\n\r\n  /*function addPost(postText){\r\n        dispatch({\r\n            type: \"ADD_POST\",\r\n            payload: postText\r\n        })\r\n    }*/\r\n\r\n  return (\r\n    <GlobalContext.Provider\r\n      value={{\r\n        popup: state.popup,\r\n        posts: state.posts,\r\n        error: state.error,\r\n        loading: state.loading,\r\n        getPosts,\r\n        togglePopup,\r\n        addPost\r\n      }}>\r\n      {children}\r\n    </GlobalContext.Provider>\r\n  );\r\n};\r\n"]},"metadata":{},"sourceType":"module"}