{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Olli\\\\Projects\\\\full stack\\\\complete\\\\login\\\\src\\\\context\\\\GlobalState.js\";\nimport React, { createContext, useReducer } from \"react\";\nimport AppReducer from \"./AppReducer\"; // Initial State\n\nconst initialState = {\n  message: \"\",\n  loggedIn: false,\n  username: \"\"\n}; // Create context\n\nexport const GlobalContext = createContext(initialState); // Provider Component\n\nexport const GlobalProvider = ({\n  children\n}) => {\n  const [state, dispatch] = useReducer(AppReducer, initialState); // Actions\n\n  async function checkAuthenticated() {\n    try {\n      const res = await fetch(\"api/v1/users/authenticated\", {\n        credentials: \"include\"\n      });\n      const response = await res.json();\n\n      if (response.error) {\n        throw response.error;\n      } else {\n        dispatch({\n          type: \"REGISTER_USER\",\n          msg: \"User successfully created\"\n        });\n      }\n\n      dispatch({\n        type: \"REGISTER_USER\",\n        msg: \"User successfully created\"\n      });\n    } catch (err) {\n      dispatch({\n        type: \"REGISTER_ERROR\",\n        msg: err\n      });\n    }\n  }\n\n  async function registerUser(user) {\n    try {\n      const res = await fetch(\"api/v1/users/register\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify(user)\n      });\n      const response = await res.json();\n\n      if (response.error) {\n        throw response.error;\n      } else {\n        dispatch({\n          type: \"REGISTER_USER\",\n          msg: \"User successfully created\"\n        });\n      }\n\n      dispatch({\n        type: \"REGISTER_USER\",\n        msg: \"User successfully created\"\n      });\n    } catch (err) {\n      dispatch({\n        type: \"REGISTER_ERROR\",\n        msg: err\n      });\n    }\n  }\n\n  async function loginUser(user) {\n    try {\n      const res = await fetch(\"api/v1/users/login\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify(user)\n      });\n      const response = await res.json();\n\n      if (response.error) {\n        throw response.error;\n      } else {\n        dispatch({\n          type: \"LOGIN_USER\",\n          msg: response.message,\n          user: response.username\n        });\n      }\n    } catch (err) {\n      dispatch({\n        type: \"LOGIN_ERROR\",\n        msg: err.data.error\n      });\n    }\n  }\n\n  return React.createElement(GlobalContext.Provider, {\n    value: {\n      message: state.message,\n      loggedIn: state.loggedIn,\n      checkAuthenticated,\n      registerUser,\n      loginUser\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105\n    },\n    __self: this\n  }, children);\n};","map":{"version":3,"sources":["C:/Users/Olli/Projects/full stack/complete/login/src/context/GlobalState.js"],"names":["React","createContext","useReducer","AppReducer","initialState","message","loggedIn","username","GlobalContext","GlobalProvider","children","state","dispatch","checkAuthenticated","res","fetch","credentials","response","json","error","type","msg","err","registerUser","user","method","headers","body","JSON","stringify","loginUser","data"],"mappings":"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","sourcesContent":["import React, { createContext, useReducer } from \"react\";\r\nimport AppReducer from \"./AppReducer\";\r\n\r\n// Initial State\r\nconst initialState = {\r\n  message: \"\",\r\n  loggedIn: false,\r\n  username: \"\"\r\n};\r\n\r\n// Create context\r\nexport const GlobalContext = createContext(initialState);\r\n\r\n// Provider Component\r\nexport const GlobalProvider = ({ children }) => {\r\n  const [state, dispatch] = useReducer(AppReducer, initialState);\r\n\r\n  // Actions\r\n  async function checkAuthenticated() {\r\n    try {\r\n      const res = await fetch(\"api/v1/users/authenticated\", {\r\n        credentials: \"include\"\r\n      });\r\n      const response = await res.json();\r\n\r\n      if (response.error) {\r\n        throw response.error;\r\n      } else {\r\n        dispatch({\r\n          type: \"REGISTER_USER\",\r\n          msg: \"User successfully created\"\r\n        });\r\n      }\r\n      dispatch({\r\n        type: \"REGISTER_USER\",\r\n        msg: \"User successfully created\"\r\n      });\r\n    } catch (err) {\r\n      dispatch({\r\n        type: \"REGISTER_ERROR\",\r\n        msg: err\r\n      });\r\n    }\r\n  }\r\n\r\n  async function registerUser(user) {\r\n    try {\r\n      const res = await fetch(\"api/v1/users/register\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\"\r\n        },\r\n        body: JSON.stringify(user)\r\n      });\r\n      const response = await res.json();\r\n      if (response.error) {\r\n        throw response.error;\r\n      } else {\r\n        dispatch({\r\n          type: \"REGISTER_USER\",\r\n          msg: \"User successfully created\"\r\n        });\r\n      }\r\n      dispatch({\r\n        type: \"REGISTER_USER\",\r\n        msg: \"User successfully created\"\r\n      });\r\n    } catch (err) {\r\n      dispatch({\r\n        type: \"REGISTER_ERROR\",\r\n        msg: err\r\n      });\r\n    }\r\n  }\r\n\r\n  async function loginUser(user) {\r\n    try {\r\n      const res = await fetch(\"api/v1/users/login\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\"\r\n        },\r\n        body: JSON.stringify(user)\r\n      });\r\n      const response = await res.json();\r\n\r\n      if (response.error) {\r\n        throw response.error;\r\n      } else {\r\n        dispatch({\r\n          type: \"LOGIN_USER\",\r\n          msg: response.message,\r\n          user: response.username\r\n        });\r\n      }\r\n    } catch (err) {\r\n      dispatch({\r\n        type: \"LOGIN_ERROR\",\r\n        msg: err.data.error\r\n      });\r\n    }\r\n  }\r\n\r\n  return (\r\n    <GlobalContext.Provider\r\n      value={{\r\n        message: state.message,\r\n        loggedIn: state.loggedIn,\r\n        checkAuthenticated,\r\n        registerUser,\r\n        loginUser\r\n      }}>\r\n      {children}\r\n    </GlobalContext.Provider>\r\n  );\r\n};\r\n"]},"metadata":{},"sourceType":"module"}